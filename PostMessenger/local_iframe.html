<html>
    <head>
        <script type="text/javascript" src="PostMessenger.min.js"></script>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css"/>
        <script type="text/javascript">
            function ready(fn) {
              if (document.readyState != 'loading'){
                fn();
              } else if (document.addEventListener) {
                document.addEventListener('DOMContentLoaded', fn);
              } else {
                document.attachEvent('onreadystatechange', function() {
                  if (document.readyState != 'loading')
                    fn();
                });
              }
            }
            
            Demo = {
                Init:function(){
                    this.pm_parent = new PostMessenger( '*', parent );
                    this.pm_parent.AddListener( this.ReceiveImportant, 'Important' );
                    this.pm_parent.AddListener( this.ReceiveTrivial, 'Trivial' );
                },
                ReceiveImportant:function( message ){
                    var d = document.createElement( 'div' );
                    d.innerHTML = 'Received important message from parent: ' + message;
                    document.querySelectorAll('#output')[ 0 ].appendChild( d );
                },
                ReceiveTrivial:function( message ){
                    var d = document.createElement( 'div' );
                    d.innerHTML = 'Received trivial message from parent: ' + message;
                    document.querySelectorAll('#output')[ 0 ].appendChild( d );
                },
                SendToParent:function(){
                    this.pm_parent.Send( 'Hello' );
                }
            }

            ready(
                function() {
                    Demo.Init();
                }
            );
        </script>
        <style type="text/css">
            #output{
                width: 99%;
                height: 170px;
                display: inline-block;
                vertical-align: top;
                border: 1px solid #ccc;
                overflow: auto;
            }
        </style>
    </head>
    <body>
        <h1>Local Iframe</h1>
        <button class="pure-button" onclick="Demo.SendToParent()">Send to parent</button>
        <div>
            <div id="output"></div>
        <div>
    </body>
</html>